<!DOCTYPE html>

<html lang="es">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Amaya Design</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display&amp;display=swap" rel="stylesheet"/>
<style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #fff;
      margin: 0;
      padding: 0;
      color: #222;
    }

    header {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 10px 0;
      position: relative;
    }

    header img {
      height: 120px;
      cursor: pointer;
      margin-top: 0;
      transition: transform 0.3s ease;
    }

    header img:hover {
      transform: scale(1.03);
    }

    .cart-icon {
      position: absolute;
      right: 20px;
      font-size: 24px;
      cursor: pointer;
      top: 50%;
      transform: translateY(-50%);
    }

    #cart-count {
      position: absolute;
      top: -8px;
      right: -8px;
      background: #e00;
      color: #fff;
      border-radius: 50%;
      padding: 2px 6px;
      font-size: 12px;
      display: none;
    }

    .overlay, .checkout-overlay {
      position: fixed;
      top: 0;
      left: 0;
      height: 100vh;
      width: 100vw;
      background: rgba(0, 0, 0, 0.5);
      z-index: 998;
      display: none;
    }

    .cart-window, .checkout-window {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 90%;
      max-width: 360px;
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.25);
      padding: 10px 0;
      z-index: 999;
      display: none;
      box-sizing: border-box;
    }

    .close-cart, .close-checkout {
      position: absolute;
      top: 10px;
      right: 15px;
      font-size: 20px;
      background: none;
      border: none;
      color: #333;
      cursor: pointer;
    }

    .cart-item, .checkout-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
    }

    .cart-item button {
      background: none;
      border: none;
      color: #a00;
      font-size: 18px;
      cursor: pointer;
      padding: 0 5px;
    }

    input, textarea {
      width: 100%;
      padding: 10px;
      margin-bottom: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      box-sizing: border-box;
    }

    button.finalizar, button.enviar {
      background: #000;
      color: #fff;
      border: none;
      padding: 12px;
      border-radius: 5px;
      width: 100%;
      font-size: 16px;
      cursor: pointer;
    }

    .search-container {
      display: flex;
      justify-content: center;
      padding: 5px 0 5px;
    }

    .search-container input {
      width: 90%;
      max-width: 500px;
      padding: 12px;
      border: 1px solid #ccc;
      border-radius: 30px;
      font-size: 16px;
    }

    .filters {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      padding: 20px 10px;
    }

    .filters button {
      padding: 10px 16px;
      border: none;
      border-radius: 20px;
      background-color: #eee;
      color: #333;
      font-size: 14px;
      cursor: pointer;
    }

    .filters button.active {
      background-color: #333;
      color: #fff;
    }

    .product-list {
      padding: 0 10px 50px;
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
    }

    .product-card {
      background: #f9f9f9;
      border-radius: 12px;
      padding: 16px;
      display: flex;
      flex-direction: column;
    }

    .product-image {
      width: 100%;
      height: 180px;
      background: linear-gradient(135deg, #ddd, #ccc);
      border-radius: 10px;
      margin-bottom: 15px;
    }

    .product-title {
  font-family: 'Montserrat', sans-serif;
  font-size: 14px;
  font-weight: 500;
  letter-spacing: 0.2px;
  color: #222;
  margin-top: 6px;
}

    .product-price {
      font-size: 16px;
      margin-bottom: 10px;
    }

    .product-card button {
      background-color: #222;
      color: #fff;
      padding: 10px;
      width: 100%;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      margin-top: auto;
    }
  
/* Modal de imagen */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0,0,0,0.7);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  opacity: 0;
  transition: opacity 0.3s ease;
}

.modal-overlay.show {
  display: flex;
  opacity: 1;
}


.modal-content {
  background: #fff;
  border-radius: 16px;
  padding: 10px 0;
  box-shadow: 0 10px 40px rgba(0,0,0,0.6);
  transition: transform 0.3s ease;
  background: #fff;
  padding: 10px;
  border-radius: 12px;
  box-shadow: 0 0 20px rgba(0,0,0,0.4);
  max-width: 90%;
  max-height: 90%;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
}

.modal-image {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 300px;
}

.modal-close, .modal-prev, .modal-next {
  position: absolute;
  background: none;
  border: none;
  color: #000;
  font-size: 28px;
  cursor: pointer;
}

.modal-close {
  top: 10px;
  right: 15px;
}

.modal-prev {
  left: 10px;
  top: 50%;
  transform: translateY(-50%);
}

.modal-next {
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
}


    /* White frame and centered images */
    .product-image {
      background-color: #fff !important;
      border-radius: 12px !important;
      padding: 10px !important;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1) !important;
      margin: 0 auto 15px auto !important;
      background-size: cover !important;
      background-position: center !important;
    }


    /* Correct overlay and modal sizing */
    .overlay, .checkout-overlay {
      background: rgba(0,0,0,0.5) !important;
    }
    .cart-window, .checkout-window {
      width: 90% !important;
      max-width: 400px !important;
      padding: 30px !important;
      border-radius: 12px !important;
      box-shadow: 0 5px 20px rgba(0,0,0,0.15) !important;
    }


    /* Centrar marcos de imágenes y mantener texto ancho completo */
    .product-card {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .product-image {
      width: calc(100% - 32px) !important;
      max-width: 100%;
      margin: 0 auto 15px auto !important;
    }
    .product-card .product-title,
    .product-card .product-price,
    .product-card button {
      width: 100%;
      text-align: center;
    }


    /* Reducir margen blanco alrededor de las imágenes */
    .product-image {
      padding: 4px !important;
      margin: 0 auto 12px auto !important;
      border-radius: 10px !important;
    }


    /* Hacer imágenes más grandes y cuadradas */
    .product-image {
      width: 100% !important;
      aspect-ratio: 1 / 1 !important;
      height: auto !important;
      padding: 0 !important;
      margin: 0 0 12px 0 !important;
      border-radius: 12px !important;
    }


    /* Reducir espacio entre productos */
    .product-list {
      gap: 8px !important;
    }


    /* Reducir espacio entre header y barra de búsqueda */
    header {
      margin-bottom: 5px !important;
    }
    .search-container {
      margin-top: 5px !important;
      padding-top: 0 !important;
    }


    /* Reducir padding de header y espacio de búsqueda */
    header {
      padding: 5px 0 !important;
      margin-bottom: 0 !important;
    }
    .search-container {
      margin-top: 5px !important;
      padding: 0 !important;
    }



.product-image {
  background: #fff;
  padding: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 10px;
}

.product-image img {
  width: 100%;
  height: auto;
  max-height: 100%;
  object-fit: contain;
  border-radius: 10px;
  image-rendering: auto;
}

/* Modal estilo Zara */
.zara-modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0,0,0,0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
}
.zara-modal {
  background: #fff;
  padding: 30px;
  border-radius: 16px;
  max-width: 500px;
  width: 90%;
  box-shadow: 0 0 40px rgba(0,0,0,0.4);
  text-align: center;
  position: relative;
}
.zara-modal-close {
  position: absolute;
  top: 10px;
  right: 15px;
  font-size: 24px;
  background: none;
  border: none;
  cursor: pointer;
}
.zara-modal img {
  width: 100%;
  max-height: 400px;
  object-fit: contain;
  margin-bottom: 20px;
}
.zara-modal-info h2 {
  font-family: 'Montserrat', sans-serif;
  font-size: 20px;
  font-weight: 500;
  letter-spacing: 0.2px;
  color: #222;
  margin: 0;
}
.zara-modal-info p {
  font-size: 18px;
  color: #444;
  margin: 10px 0 20px;
}
.zara-add-button {
  background: #fff;
  border: 1px solid #000;
  color: #000;
  padding: 10px 24px;
  font-size: 16px;
  border-radius: 30px;
  cursor: pointer;
  transition: all 0.3s ease;
}
.zara-add-button:hover {
  background: #000;
  color: #fff;
}


/* ---- Selector de color para modal de producto ---- */
.color-picker{margin:10px 0 16px;display:flex;gap:8px;justify-content:center;align-items:center;flex-wrap:wrap}
.color-picker .label{font-size:14px;margin-right:6px}
.color-swatch{width:28px;height:28px;border-radius:50%;border:1px solid #ccc;cursor:pointer;outline:none}
.color-swatch[aria-pressed="true"]{box-shadow:0 0 0 2px #000 inset;border-color:#000}
.color-name{width:100%;text-align:center;font-size:12px;color:#555;margin-top:6px}


/* ===== Selector de talla (añadido) ===== */
.size-picker{margin:8px 0 16px;display:flex;gap:6px;justify-content:center;flex-wrap:wrap}
.size-picker .label{font-size:14px;margin-right:6px}
.size-btn{padding:6px 12px;border:1px solid #ccc;border-radius:4px;background:#fff;cursor:pointer;font-size:13px}
.size-btn[aria-pressed="true"]{border-color:#000;background:#f2f2f2}

/* ==== Ajuste modal móvil: todo visible sin scroll de página ==== */
@media (max-width: 480px){
  .zara-modal-overlay{align-items:center;justify-content:center;}
  .zara-modal{
    width: 96vw;
    max-height: 92vh;
    display: grid;
    grid-template-rows: auto 1fr;
    border-radius: 16px;
    padding: 16px;
  }
  .zara-modal img{
    max-height: 38vh;
    width: 100%;
    object-fit: contain;
    background: #fff;
    margin-bottom: 12px;
  }
  .zara-modal-info{
    display: flex;
    flex-direction: column;
    gap: 8px;
    overflow: auto;
    padding: 8px;
  }
  #zaraModalTitle{
    font-size: 20px;
    line-height: 1.2;
    margin: 0;
    text-align: center;
  }
  #zaraModalPrice{
    margin: 4px 0 6px;
    text-align: center;
  }
  .color-picker, .size-picker{
    justify-content: center;
    gap: 8px;
    flex-wrap: wrap;
  }
  .size-btn{padding: 6px 10px;}
  .zara-add-button{
    position: sticky;
    bottom: 0;
    margin-top: 8px;
    padding: 12px 16px;
    border-radius: 999px;
  }
}
.zara-modal{
    width: 96vw;
    max-height: 92vh;
    display: grid;
    grid-template-rows: auto 1fr;
    border-radius: 16px;
    padding: 16px;
  }
  evh;
    object-fit: contain;
    background: #fff;
    margin-bottom: 12px;
  }
  .zara-modal-info{
    display: flex;
    flex-direction: column;
    gap: 8px;
    overflow: auto;
    padding: 8px;
  }
  #zaraModalTitle{
    font-size: 20px;
    line-height: 1.2;
    margin: 0;
    text-align: center;
  }
  #zaraModalPrice{
    margin: 4px 0 6px;
    text-align: center;
  }
  .color-picker, .size-picker{
    justify-content: center;
    gap: 8px;
    flex-wrap: wrap;
  }
  .size-btn{padding: 6px 10px;}
  .zara-add-button{
    position: sticky;
    bottom: 0;
    margin-top: 8px;
    padding: 12px 16px;
    border-radius: 999px;
  }
}


.product-card button:not(.color-swatch):not(.size-btn){display:none !important;}

/* === Variantes en tarjetas: reutilizamos estilos del modal === */
.card-variants { 
  margin: 8px 0 4px; 
  display: flex; 
  gap: 8px; 
  justify-content: center; 
  align-items: center; 
  flex-wrap: wrap;
}


/* === Variantes en tarjetas con el MISMO estilo que el hooking === */
.card-variants.color-picker{margin:8px 0 6px}
.card-variants .label{font-size:14px;margin-right:6px}
.card-variants .color-swatch{width:28px;height:28px;border-radius:50%;border:1px solid #ccc;cursor:pointer;outline:none}
.card-variants .color-swatch[aria-pressed="true"]{box-shadow:0 0 0 2px #000 inset;border-color:#000}
.card-variants .color-name{width:100%;text-align:center;font-size:12px;color:#555;margin-top:6px}


/* === Variantes en tarjetas: estilo minimal (solo círculos) === */
.card-variants {
  margin: 6px 0 4px;
  display: flex;
  gap: 8px;
  justify-content: center;
  align-items: center;
}
.card-variants .color-swatch {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  border: 1px solid #ccc;
  cursor: pointer;
  outline: none;
}
.card-variants .color-swatch[aria-pressed="true"] {
  box-shadow: 0 0 0 2px #000 inset;
  border-color: #000;
}


/* Texto con cantidad de colores en tarjetas */
.product-colors{
  font-family: 'Montserrat', sans-serif;
  font-size: 13px;
  color: #555;
  text-align: center;
  margin-top: 4px;
}


/* Badge profesional "X colores" en esquina de la imagen */
.product-card .product-image{ position: relative; }
.product-colors-badge{
  position: absolute;
  top: 6px;
  right: 6px;
  background: rgba(255,255,255,0.85);
  padding: 2px 8px;
  border-radius: 12px;
  font-size: 11px;
  line-height: 1;
  font-family: 'Montserrat', sans-serif;
  color: #333;
  border: 1px solid rgba(0,0,0,0.08);
  backdrop-filter: blur(2px);
}

</style>

<style>

/* === Modal móvil sin scroll general: botón AÑADIR siempre visible === */
@media (max-width: 700px){
  .zara-modal{
    display: flex !important;
    flex-direction: column !important;
    max-height: 90vh !important;
    width: 96vw !important;
    overflow: hidden !important;
    border-radius: 16px !important;
    padding: 12px 12px calc(12px + env(safe-area-inset-bottom, 8px)) 12px !important;
  }
  .zara-modal img{
    max-height: 38vh !important;  /* menos altura para liberar espacio */
    width: 100% !important;
    object-fit: contain !important;
    margin: 0 auto 8px auto !important;
  }
  .zara-modal-info{
    flex: 1 1 auto !important;
    overflow: auto !important;           /* solo esta parte puede desplazarse */
    padding-bottom: 84px !important;     /* hueco para el botón sticky */
  }
  /* Botón 'AÑADIR' pegado al borde inferior del modal */
  .zara-add-button{
    position: sticky !important;
    bottom: 0 !important;
    left: 0 !important;
    right: 0 !important;
    display: block !important;
    width: 100% !important;
    margin: 8px 0 0 0 !important;
    padding: 14px 16px !important;
    font-size: 18px !important;
    border-radius: 999px !important;
    z-index: 3 !important;
  }
}


.product-card button:not(.color-swatch):not(.size-btn){display:none !important;}
</style>

<style>
.product-card{ cursor:pointer; }
.product-card button{ cursor:default; }

.product-card button:not(.color-swatch):not(.size-btn){display:none !important;}
</style>


<style>
.product-card {
  cursor: pointer;
  outline: none;
}
.product-card:focus {
  outline: none;
}
.product-card * {
  outline: none;
}
.product-card button {
  cursor: default;
}

.product-card button:not(.color-swatch):not(.size-btn){display:none !important;}
</style>


<style>
/* Quitar por completo el “flash” azul de Android/Chrome */
.product-card,
.product-card *,
.product-card a,
.product-card button,
.product-card img {
  -webkit-tap-highlight-color: rgba(0,0,0,0) !important;
  -webkit-touch-callout: none;
}
/* Sin contorno en cualquier estado de foco/click */
.product-card:focus,
.product-card:focus-visible,
.product-card:active,
.product-card *:focus,
.product-card *:focus-visible,
.product-card *:active {
  outline: none !important;
  box-shadow: none !important;
}
/* Mantener el cursor correcto */
.product-card { cursor: pointer; }
.product-card button { cursor: default; }

.product-card button:not(.color-swatch):not(.size-btn){display:none !important;}
</style>


<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500&display=swap" rel="stylesheet">
<style>
  .product-title {
  font-family: 'Montserrat', sans-serif;
  font-size: 14px;
  font-weight: 500;
  letter-spacing: 0.2px;
  color: #222;
  margin-top: 6px;
}
</style>

</head>
<body>
<header>
<img alt="Amaya Design" onclick="location.reload()" src="logo-amaya.png"/>
<div class="cart-icon" onclick="toggleCart()" title="Ver carrito">
<svg fill="none" height="26" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="26" xmlns="http://www.w3.org/2000/svg">
<circle cx="9" cy="21" r="1"></circle>
<circle cx="20" cy="21" r="1"></circle>
<path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
</svg><span id="cart-count"></span>
</div>
</header>
<div class="overlay" id="overlay" onclick="toggleCart()"></div>
<div class="checkout-overlay" id="checkoutOverlay" onclick="cerrarCheckout()"></div>
<div class="cart-window" id="cartWindow">
<button class="close-cart" onclick="toggleCart()">✖</button>
<h3>Carrito</h3>
<div id="envioGratisBarra" style="font-size:13px; color:#555; margin-bottom:10px;"></div>
<div id="cart"></div>
<button class="finalizar" onclick="abrirInfo()">Finalizar pedido</button>
</div>
<div class="checkout-window" id="checkoutWindow">
<button class="close-checkout" onclick="cerrarCheckout()">✖</button>
<h3>Revisar y Enviar Pedido</h3>
<div id="checkoutResumen"></div>
<input id="nombre" placeholder="Tu nombre completo" type="text"/>
<input id="telefono" placeholder="Tu número de teléfono" type="text"/>
<textarea id="direccion" placeholder="Dirección de entrega"></textarea>
<button class="enviar" onclick="enviarPedido()">Enviar por WhatsApp</button>
</div>
<div class="search-container">
<input id="busqueda" oninput="filtrarProductos()" placeholder="Buscar productos..." type="text"/>
</div>
<div class="filters">
<button class="active" onclick="filtrarCategoria('todos', this)">Todos</button>
<button onclick="filtrarCategoria('mujer', this)">Mujer</button>
<button onclick="filtrarCategoria('hombre', this)">Hombre</button>
<button onclick="filtrarCategoria('infantil', this)">Infantil</button>
<button onclick="filtrarCategoria('hogar', this)">Hogar</button>
<button onclick="filtrarCategoria('regalos', this)">Regalos</button>
</div>
<div class="product-list" id="lista-productos"></div>
<script>
    

const productos = [
  {
    nombre: "Sudadera M5",
    precio: 21.99,
    categoria: "hombre",
    imagenes: ["fotos/sudadera_m5.jpg"]
  },
  {
    nombre: "Chaqueta NK",
    precio: 18.99,
    categoria: "hombre",
    imagenes: ["fotos/Chaqueta NK Beige.png"]
  },
  {
    nombre: "Sudadera Sparco",
    precio: 21.99,
    categoria: "hombre",
    imagenes: ["fotos/Sudadera Sparco.jpg"]
  },
  {
    nombre: "Sudadera NK",
    precio: 17.99,
    categoria: "hombre",
    imagenes: ["fotos/Sudadera NK.jpg"]
  },
  {
    nombre: "Sudadera Kawasaki",
    precio: 21.99,
    categoria: "hombre",
    imagenes: ["fotos/Sudadera Kawasaki.jpg"]
  },
      {
        nombre: "Jersey Dior",
        precio: 20.99,
        categoria: "hombre",
        imagenes: ["fotos/Jersey Dior.jpg"]
      },
      {
        nombre: "Set de Regalo",
        precio: 49.99,
        categoria: "regalos",
        imagenes: ["fotos/set_regalo1.jpg", "fotos/set_regalo1b.jpg"]
      },

];



    let carrito = [];

    window.onload = () => {
      setTimeout(agregarEventosModalZara, 100);
      const guardado = localStorage.getItem("carrito");
      if (guardado) carrito = JSON.parse(guardado);
      mostrarCarrito();
      actualizarBarraEnvio();
      actualizarContadorCarrito();
      renderizarProductos(productos);
    };

    function renderizarProductos(lista) {
      const contenedor = document.getElementById("lista-productos");
      contenedor.innerHTML = "";
      lista.forEach((p, index) => {
        contenedor.innerHTML += `
        <div class="product-card">
          <div class=\"product-image\" onclick=\"openModal(${index})\"><img src=\"${p.imagenes[0]}\" alt=\"${p.nombre}\" loading=\"lazy\"/></div>
          <div class="product-title">${p.nombre}</div>
          <div class="product-price">${p.precio.toFixed(2)} €</div>
          </div>`;
      });
    }

    function filtrarCategoria(cat, boton) {
      document.querySelectorAll(".filters button").forEach(b => b.classList.remove("active"));
      boton.classList.add("active");
      filtrarProductos();
    }

    function filtrarProductos() {
      const texto = document.getElementById("busqueda").value.toLowerCase();
      const categoria = document.querySelector(".filters button.active").textContent.toLowerCase();
      const resultado = productos.filter(p =>
        (!categoria || categoria === "todos" || p.categoria === categoria) &&
        p.nombre.toLowerCase().includes(texto)
      );
      renderizarProductos(resultado);
    }

    function toggleCart() {
      const ventana = document.getElementById("cartWindow");
      const overlay = document.getElementById("overlay");
      const visible = ventana.style.display === "block";
      ventana.style.display = visible ? "none" : "block";
      overlay.style.display = visible ? "none" : "block";
    }

    function abrirCheckout() {
      if (carrito.length === 0) return alert("El carrito está vacío.");
      const resumen = document.getElementById("checkoutResumen");
      resumen.innerHTML = "";
      let total = 0;
      carrito.forEach(p => {
        resumen.innerHTML += `<div class="checkout-item">${p.nombre} x${p.cantidad} - ${(p.precio * p.cantidad).toFixed(2)} €</div>`;
        total += p.precio * p.cantidad;
      });
      resumen.innerHTML += `<strong>Total: ${total.toFixed(2)} €</strong>`;
      resumen.innerHTML += `<p style="font-size:13px; color:#666; margin-top:10px;">Envíos: 1 o 2 días<br>Pedidos de más de 40€ → <strong>envío gratuito</strong></p>`;
      document.getElementById("cartWindow").style.display = "none";
      document.getElementById("overlay").style.display = "none";
      document.getElementById("checkoutWindow").style.display = "block";
      document.getElementById("checkoutOverlay").style.display = "block";
    }

    function cerrarCheckout() {
      document.getElementById("checkoutWindow").style.display = "none";
      document.getElementById("checkoutOverlay").style.display = "none";
    }

    function addToCart(nombre, precio) {
      const index = carrito.findIndex(p => p.nombre === nombre);
      if (index !== -1) carrito[index].cantidad++;
      else carrito.push({ nombre, precio, cantidad: 1 });
      localStorage.setItem("carrito", JSON.stringify(carrito));
      mostrarCarrito();
      actualizarBarraEnvio();
      actualizarContadorCarrito();
    }

    function eliminarDelCarrito(index) {
      if (carrito[index].cantidad > 1) carrito[index].cantidad--;
      else carrito.splice(index, 1);
      localStorage.setItem("carrito", JSON.stringify(carrito));
      mostrarCarrito();
      actualizarBarraEnvio();
      actualizarContadorCarrito();
    }

    function mostrarCarrito() {
      const contenedor = document.getElementById("cart");
      contenedor.innerHTML = "";
      carrito.forEach((item, index) => {
        contenedor.innerHTML += `
          <div class="cart-item">
            <span>${item.nombre} (${item.cantidad}) - ${(item.precio * item.cantidad).toFixed(2)} €</span>
            <button onclick="eliminarDelCarrito(${index})">🗑️</button>
          </div>`;
      });
    }

    function actualizarBarraEnvio() {
      const barra = document.getElementById("envioGratisBarra");
      if (!barra) return;
      let total = carrito.reduce((acc, p) => acc + p.precio * p.cantidad, 0);
      barra.innerHTML = total >= 40
        ? '<strong>¡Envío gratuito activado!</strong>'
        : `Añade ${(40 - total).toFixed(2)} € más para envío gratuito.`;
    }

    function actualizarContadorCarrito() {
      const contador = document.getElementById("cart-count");
      const total = carrito.reduce((sum, p) => sum + p.cantidad, 0);
      contador.style.display = total > 0 ? "inline-block" : "none";
      contador.textContent = total;
    }

    function enviarPedido() {
      const nombre = document.getElementById("nombre").value.trim();
      const telefono = document.getElementById("telefono").value.trim();
      const direccion = document.getElementById("direccion").value.trim();
      if (!nombre || !telefono || !direccion) return alert("Completa todos los datos.");
      let mensaje = `*Nuevo pedido desde Amaya Design*%0A*Nombre:* ${encodeURIComponent(nombre)}%0A*Teléfono:* ${encodeURIComponent(telefono)}%0A*Dirección:* ${encodeURIComponent(direccion)}%0A%0A*Productos:*%0A`;
      let total = 0;
      carrito.forEach(p => {
        mensaje += `- ${p.nombre} x${p.cantidad}: ${(p.precio * p.cantidad).toFixed(2)} €%0A`;
        total += p.precio * p.cantidad;
      });
      mensaje += `%0A*Total:* ${total.toFixed(2)} €`;
      carrito = [];
      localStorage.removeItem("carrito");
      mostrarCarrito();
      actualizarBarraEnvio();
      actualizarContadorCarrito();
      window.open(`https://wa.me/34603603321?text=${mensaje}`, "_blank");
    }
  



function abrirInfo() {
  if (carrito.length === 0) {
    toggleCart(); // Cierra la ventana si está abierta
    alert("El carrito está vacío.");
    return;
  }
  abrirCheckout(); // Solo abrir checkout si no está vacío
  document.getElementById("checkoutWindow").style.display = "none";
  document.getElementById("checkoutOverlay").style.display = "none";
  document.getElementById("infoWindow").style.display = "block";
  document.getElementById("infoOverlay").style.display = "block";
}

function cerrarInfo() {
  document.getElementById("infoWindow").style.display = "none";
  document.getElementById("infoOverlay").style.display = "none";
}

function confirmarInfo() {
  cerrarInfo();
  document.getElementById("checkoutWindow").style.display = "block";
  document.getElementById("checkoutOverlay").style.display = "block";
}

function openZaraModal(product, index) {
  window.currentZaraProduct = index;
  document.getElementById("zaraModalImage").src = product.image;
  document.getElementById("zaraModalTitle").textContent = product.name;
  document.getElementById("zaraModalPrice").textContent = product.price;
  document.getElementById("zaraModal").style.display = "flex";
}
function closeZaraModal() {
  document.getElementById("zaraModal").style.display = "none";
}
function agregarEventosModalZara() {
  document.querySelectorAll(".product-image").forEach((img, index) => {
    img.addEventListener("click", () => {
      const producto = productos[index];
      openZaraModal({ image: producto.imagenes[0], name: producto.nombre, price: producto.precio.toFixed(2) + " €" }, index);
    });
  });
}



function addToCartFromModal() {
  if (window.currentZaraProduct !== undefined) {
    const p = productos[window.currentZaraProduct];
    addToCart(p.nombre, p.precio);
    closeZaraModal();
  }
}
</script>
<!-- Modal -->
<div class="modal-overlay" id="imageModal">
<div class="modal-content">
<button class="modal-close" onclick="closeModal()">✖</button>
<button class="modal-prev" onclick="prevImage()">‹</button>
<div class="modal-image" id="modalImage"></div>
<button class="modal-next" onclick="nextImage()">›</button>
</div>
</div>
<div class="checkout-overlay" id="infoOverlay" style="display:none;"></div>
<div class="checkout-window" id="infoWindow" style="display:none;">
<button class="close-checkout" onclick="cerrarInfo()">✖</button>
<h3>Información sobre el pedido</h3>
<p style="padding: 0 15px; font-size:14px; color:#333;">
    Actualmente disponemos de <strong>contrarreembolso</strong> o <strong>Bizum</strong>.<br/><br/>
    Se le redirigirá a WhatsApp para completar el pedido. Se puede cancelar en cualquier momento.<br/><br/>
    Envíos de 1 a 2 días según la hora del pedido.<br/>
    Aceptamos devoluciones en cuanto recibamos el producto. Toda la información se le dará en el chat.<br/><br/>
    Para cualquier duda, escríbanos por WhatsApp.
  </p>
<button class="finalizar" onclick="confirmarInfo()">Aceptar</button>
</div>
<!-- Modal Zara -->
<div class="zara-modal-overlay" id="zaraModal" style="display:none;">
<div class="zara-modal">
<button class="zara-modal-close" onclick="closeZaraModal()">✖</button>
<img alt="Imagen del producto" id="zaraModalImage" src=""/>
<div class="zara-modal-info">
<h2 id="zaraModalTitle"></h2>
<p id="zaraModalPrice"></p>
<button class="zara-add-button" onclick="addToCartFromModal()">AÑADIR</button>
</div>
</div>
</div>

<script>
// Variantes de color por producto
const VARIANTES = {
  
  "Sudadera NK": {
    default: "Gris",
    items: {
      "Gris": { hex:"#888888", img:"fotos/sudadera NK mano.jpg" }
    }
  },
"Sudadera M5": {
    default: "Negro",
    items: {
      "Negro": { hex:"#111111", img:"fotos/sudadera_m5.jpg" }
    }
  },
  "Chaqueta NK": {
    default: "Beige",
    items: {
      "Beige": { hex:"#d9c7a6", img:"fotos/Chaqueta NK Beige.png" },
      "Negro": { hex:"#111111", img:"fotos/Chaqueta NK Negra.png" },
      "Azul": { hex:"#1f6feb", img:"fotos/Chaqueta NK Azul.png" },
      "Rojo": { hex:"#e10600", img:"fotos/Chaqueta NK Rojo.png" }
    }
  },
  "Sudadera Sparco": {
    default: "Negro",
    items: {
      "Negro": { hex:"#111111", img:"fotos/Sudadera Sparco.jpg" },
    }
  },
  "Sudadera Kawasaki": {
    default: "Negro",
    items: {
      "Negro": { hex:"#111111", img:"fotos/Sudadera Kawasaki.jpg" },
    }
  },
  "Jersey Dior": {
    default: "Negro",
    items: {
      "Beige": { hex:"#d9c7a6", img:"fotos/set_de_regalo_beige.jpg" },
      "Negro": { hex:"#111111", img:"fotos/set_de_regalo_negro.jpg" },
      "Blanco": { hex:"#eaeaea", img:"fotos/set_de_regalo_blanco.jpg" },
      "Azul": { hex:"#1f6feb", img:"fotos/set_de_regalo_azul.jpg" },
      "Rojo": { hex:"#e10600", img:"fotos/set_de_regalo_rojo.jpg" }
    }
  }
};

function renderColorPicker(nombreProd){
  const conf = VARIANTES[nombreProd];
  const modal = document.getElementById("zaraModal");
  const infoBox = modal.querySelector(".zara-modal-info");
  if(!infoBox) return;
  let exist = modal.querySelector("#colorPicker");
  if(!conf){
    if(exist) exist.remove();
    window.selectedColor = null;
    return;
  }
  if(!exist){
    exist = document.createElement("div");
    exist.id = "colorPicker";
    exist.className = "color-picker";
    infoBox.insertBefore(exist, infoBox.querySelector(".zara-add-button"));
  }
  const entries = Object.entries(conf.items);
  // Usar color preseleccionado desde la tarjeta si existe y es válido
  let def = (window.preselectedColor && conf.items[window.preselectedColor]) ? window.preselectedColor : (conf.default && conf.items[conf.default] ? conf.default : entries[0][0]);
  window.selectedColor = def;
exist.innerHTML = '<span class="label">Color:</span>' + entries.map(([nombre,data])=>{
    return `<button class="color-swatch" title="${nombre}" data-color="${nombre}" style="background:${data.hex}" aria-pressed="${nombre===def}"></button>`;
  }).join("") + `<div class="color-name" id="colorName">${def}</div>`;

  exist.querySelectorAll(".color-swatch").forEach(btn=>{
    btn.addEventListener("click", ()=>{
      const color = btn.getAttribute("data-color");
      window.selectedColor = color;
      exist.querySelectorAll(".color-swatch").forEach(b=>b.setAttribute("aria-pressed","false"));
      btn.setAttribute("aria-pressed","true");
      exist.querySelector("#colorName").textContent = color;
      const data = conf.items[color];
      if(data?.img){ document.getElementById("zaraModalImage").src = data.img; }
      document.getElementById("zaraModalTitle").textContent = nombreProd + " - " + color;
    });
  });

  // Inicializar por defecto
  const defData = conf.items[def];
  if(defData?.img){ document.getElementById("zaraModalImage").src = defData.img; }
  document.getElementById("zaraModalTitle").textContent = nombreProd + " - " + def;
}

// Parches suaves para openZaraModal y addToCartFromModal
const _openZara = window.openZaraModal;
window.openZaraModal = function(product, index){
  _openZara(product, index);
  renderColorPicker(product.name);
  renderSizePicker(product.name);
};

const _addToCart = window.addToCartFromModal;
window.addToCartFromModal = function(){
  if(window.currentZaraProduct !== undefined){
    const p = productos[window.currentZaraProduct];
    const conf = VARIANTES[p.nombre];
    if(conf){
      const color = window.selectedColor || conf.default;
      const talla = window.selectedSize || "M";
      addToCart(p.nombre + " (" + color + " - " + talla + ")", p.precio);
      closeZaraModal();
      return;
    }
  }
  _addToCart();
};
</script>


<script>
const DEFAULT_SIZES = ["XXS","XS","S","M","L","XL"];
function renderSizePicker(nombreProd){
  const conf = (typeof VARIANTES !== "undefined") ? (VARIANTES[nombreProd] || null) : null;
  const tallas = (conf && Array.isArray(conf.tallas) && conf.tallas.length) ? conf.tallas : DEFAULT_SIZES;
  const modal = document.getElementById("zaraModal");
  const infoBox = modal && modal.querySelector(".zara-modal-info");
  if(!infoBox) return;
  let exist = modal.querySelector("#sizePicker");
  if(!exist){
    exist = document.createElement("div");
    exist.id = "sizePicker";
    exist.className = "size-picker";
    const addBtn = infoBox.querySelector(".zara-add-button") || infoBox.lastElementChild;
    infoBox.insertBefore(exist, addBtn);
  }
  const def = tallas.includes("M") ? "M" : tallas[0];
  window.selectedSize = def;
  exist.innerHTML = '<span class="label">Talla:</span>' + tallas.map(t => `<button class="size-btn" data-size="${t}" aria-pressed="${t===def}">${t}</button>`).join("");
  exist.querySelectorAll(".size-btn").forEach(btn=>{
    btn.addEventListener("click", ()=>{
      const talla = btn.getAttribute("data-size");
      window.selectedSize = talla;
      exist.querySelectorAll(".size-btn").forEach(b=>b.setAttribute("aria-pressed","false"));
      btn.setAttribute("aria-pressed","true");
    });
  });
}
</script>


<script>
// ==== Carga robusta de imagen para variantes ====
(function(){
  function trySetImage(srcList){
    const img = document.getElementById("zaraModalImage");
    if(!img || !srcList || !srcList.length) return;
    const prev = img.getAttribute("src") || "";
    let i = 0;
    function next(){
      if(i >= srcList.length){ img.onerror = null; img.src = prev; return; }
      const s = srcList[i++];
      img.onerror = next;
      img.src = s;
    }
    next();
  }
  // Helper: genera rutas alternativas razonables
  function altPaths(original){
    if(!original) return [];
    const uniq = new Set();
    const parts = [original];
    // reemplazos: espacios -> _, minúsculas
    parts.push(original.replace(/\s+/g,"_"));
    parts.push(original.toLowerCase());
    parts.push(original.toLowerCase().replace(/\s+/g,"_"));
    // si no empieza por fotos/, lo probamos
    if(!/^fotos\//i.test(original)){
      const base = original.replace(/^\.\/?/, "");
      parts.push("fotos/" + base);
      parts.push("fotos/" + base.toLowerCase());
      parts.push("fotos/" + base.toLowerCase().replace(/\s+/g,"_"));
    }
    parts.forEach(p=>uniq.add(p));
    return Array.from(uniq);
  }

  // Exponer en global para usar desde renderColorPicker si existe
  window.__trySetVariantImage = function(imgPath, fallback){
    const list = altPaths(imgPath);
    if(fallback){ list.push(fallback); }
    trySetImage(list);
  };
})();
</script>


<!-- Override mínimo y seguro: lista visible + reenganche modal -->
<script>
// Lista de productos visibles en pantalla
window.__listaActual = window.productos || [];

// Sobrescribe de forma no intrusiva (la última definición gana)






window.renderizarProductos = function(lista) {
  const contenedor = document.getElementById("lista-productos");
  if (!contenedor) return;
  contenedor.innerHTML = "";
  window.__listaActual = (Array.isArray(lista) && lista.length) ? lista : (window.productos || []);

  window.__listaActual.forEach((p, index) => {
    const precio = (p && p.precio != null) ? (p.precio.toFixed ? p.precio.toFixed(2) : p.precio) : "";
    const variantes = (typeof VARIANTES !== "undefined") ? VARIANTES[p?.nombre] : null;
    const coloresCount = variantes && variantes.items ? Object.keys(variantes.items).length : 0;
    const coloresLabel = coloresCount > 0 ? (coloresCount + (coloresCount === 1 ? " color" : " colores")) : "";

    contenedor.innerHTML += `
      <div class="product-card" data-index="${index}">
        <div class="product-image">
          ${coloresLabel ? `<span class="product-colors-badge">${coloresLabel}</span>` : ``}
          <img src="${(p.imagenes && p.imagenes[0]) || p.imagen || ""}" alt="${p.nombre || ""}" loading="lazy"/>
        </div>
        <div class="product-title">${p.nombre || ""}</div>
        <div class="product-price">${precio} €</div>
        <button onclick="addToCart('${p ? (p.nombre || "") : ""}', ${p ? (p.precio || 0) : 0})">Añadir al carrito</button>
      </div>`;
  });

  // Reenganchar apertura del modal
  if (typeof window.agregarEventosModalZara === "function") window.agregarEventosModalZara();
};







window.agregarEventosModalZara = function() {
  const cards = document.querySelectorAll(".product-image");
  cards.forEach((img, index) => {
    img.onclick = null;
    img.addEventListener("click", () => {
      const lista = window.__listaActual && window.__listaActual.length ? window.__listaActual : (window.productos || []);
      const producto = lista[index];
      if (!producto) return;

      if (typeof window.openZaraModal === "function") {
        window.openZaraModal(
          { image: (producto.imagenes && producto.imagenes[0]) || producto.imagen || "", name: producto.nombre, price: ((producto.precio && producto.precio.toFixed) ? producto.precio.toFixed(2) : producto.precio) + " €" },
          index
        );
      }
      if (typeof window.renderColorPicker === "function") window.renderColorPicker(producto.nombre);
      if (typeof window.renderSizePicker === "function") window.renderSizePicker(producto.nombre);
    });
  });
};
</script>


<!-- Forzar botón AÑADIR visible y sticky en el modal (añade clase si falta) -->
<script>
(function(){
  function etiquetarBotonAnadir(){
    try{
      var modal = document.querySelector('.zara-modal');
      if(!modal) return;
      // Busca un botón con texto "AÑADIR"
      var btns = modal.querySelectorAll('button, .btn, .add-to-cart');
      for (var i=0;i<btns.length;i++){
        var t = (btns[i].textContent || '').trim().toUpperCase();
        if (t.includes('AÑADIR')){
          btns[i].classList.add('zara-add-button');
          break;
        }
      }
    }catch(e){}
  }
  // Al abrir el modal, etiquetar el botón
  var _open = window.openZaraModal;
  window.openZaraModal = function(data, idx){
    if (typeof _open === 'function') _open.apply(this, arguments);
    setTimeout(etiquetarBotonAnadir, 50);
  };
  // Si el modal ya está abierto en este momento
  setTimeout(etiquetarBotonAnadir, 100);
})();
</script>


<script>
(function(){
  // Engancha el click en toda la tarjeta, no solo en la imagen
  window.agregarEventosModalZara = function() {
    const cards = document.querySelectorAll(".product-card");
    const lista = (window.__listaActual && window.__listaActual.length) ? window.__listaActual : (window.productos || []);

    cards.forEach((card, index) => {
      // abrir modal al pulsar en cualquier parte de la tarjeta
      card.onclick = function () {
        // Tomar color seleccionado en la tarjeta y pre-seleccionarlo en el modal
        var pressed = card.querySelector('.card-variants .color-swatch[aria-pressed="true"]');
        window.preselectedColor = pressed ? pressed.getAttribute('data-color') : null;
    
        const producto = lista[index];
        if (!producto) return;

        if (typeof window.openZaraModal === "function") {
          window.openZaraModal(
            { image: (producto.imagenes && producto.imagenes[0]) || "", name: producto.nombre, price: (Number(producto.precio)||0).toFixed(2) + " €" },
            index
          );
        }
        // Render de variantes si existen
        if (typeof window.renderColorPicker === "function") window.renderColorPicker(producto.nombre);
        if (typeof window.renderSizePicker === "function") window.renderSizePicker(producto.nombre);
      };

      // impedir que el botón abra el modal
      const btn = card.querySelector("button");
      if (btn) {
        btn.addEventListener("click", function(ev){
          ev.stopPropagation();
          try {
            const producto = lista[index];
            if (producto && typeof window.addToCart === "function") {
              const img0 = (producto.imagenes && producto.imagenes[0]) || "";
              window.addToCart(producto.nombre, producto.precio, img0);
            }
          } catch(e){}
        });
      }
    });
  };
})();
</script>

</body>
</html>
